<h1 id="angular-stencil-web-">Angular + Stencil 构建 Web 组件</h1>
<p>使用 Stencil 构建含有 Angular CLI 项目的 web 组件集合需要3个步骤。我们需要:</p>
<ol>
<li>在使用组件的 modules 中包含 CUSTOM_ELEMENTS_SCHEMA</li>
<li>在 <code>index.html</code> 中包含载入脚本</li>
<li>构建过程中复制组件集合</li>
</ol>
<h2 id="-custom-elements-schema">包含 Custom Elements Schema</h2>
<p>在 modules 中包含 CUSTOM_ELEMENTS_SCHEMA 允许你使用 web 组件中而不会让编译器产生错误。这是一个将其添加到 <code>AppModule</code> 的例子：</p>
<pre><code class="lang-ts"><span class="hljs-keyword">import</span> { BrowserModule } <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/platform-browser'</span>;
<span class="hljs-keyword">import</span> { NgModule, CUSTOM_ELEMENTS_SCHEMA } <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;

<span class="hljs-keyword">import</span> { AppComponent } <span class="hljs-keyword">from</span> <span class="hljs-string">'./app.component'</span>;

@NgModule({
  declarations: [
    AppComponent
  ],
  imports: [
    BrowserModule
  ],
  providers: [],
  bootstrap: [AppComponent],
  schemas: [
    CUSTOM_ELEMENTS_SCHEMA
  ]
})
<span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AppModule</span> { }</span>
</code></pre>
<h2 id="-">包含载入脚本</h2>
<p>一个由 Stencil 构建的组件集合，包含了一个主脚本用于载入这些组件集合。该脚本需要像这样在你的应用中载入：</p>
<pre><code class="lang-html"><span class="hljs-meta">&lt;!doctype html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Test Component Usage<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">base</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/stencil-site/"</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"icon"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"image/x-icon"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"favicon.ico"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">'test-components/testcomponents.js'</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">app-root</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">app-root</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h2 id="-">复制组件</h2>
<p>在构建过程中，组件需要被复制到输出文件夹。最简单的方法是修改 <code>.angular-cli.json</code> 文件里的 <code>assets</code> 数组，将组件集合添加到其中。</p>
<pre><code>      <span class="hljs-string">"assets"</span>: [
        <span class="hljs-string">"assets"</span>,
        <span class="hljs-string">"favicon.ico"</span>,
        { <span class="hljs-string">"glob"</span>: <span class="hljs-string">"**/*"</span>, <span class="hljs-string">"input"</span>: <span class="hljs-string">"../web-components/test-components"</span>, <span class="hljs-string">"output"</span>: <span class="hljs-string">"./test-components"</span> }
      ],
</code></pre><p><stencil-route-link url="/stencil-site/docs/distribution" router="#router" custom="true">
  <button class='backButton'>
    返回
  </button>
</stencil-route-link></p>
<p><stencil-route-link url="/stencil-site/docs/routing" custom="true">
  <button class='nextButton'>
    继续
  </button>
</stencil-route-link></p>
